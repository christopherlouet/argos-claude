# Claude Code Usage - Argos Plugin

An [Argos](https://github.com/p-e-w/argos) plugin for GNOME Shell that displays Claude Code usage statistics directly in your panel.

## Preview

**Panel display:**
```
󰧑  1.0M │ Opus │ $741/w
```

**Dropdown menu:**
```
  Claude Code  Max
─────────────────────────
ACTIVITY
├─ Today         109K
├─ Week          1.0M  ▅▇▄█▂▃▁
└─ Total         6.4M  (36d)

SAVINGS vs API
├─ Week          $741
├─ Month         $4,281
└─ Total         $4,476

  my-project

󰔃  View usage on claude.ai
󰅂  Refresh
```

## Features

- **Weekly token count** with 7-day sparkline graph
- **Current model** indicator (Opus/Sonnet/Haiku)
- **API cost equivalent** - see how much you're saving vs direct API usage
- **Subscription type** display (Max/Pro)
- **Active sessions** count (when multiple Claude instances are running)
- **Last active project** name
- **Direct link** to Claude.ai usage page

## Requirements

- [Argos](https://extensions.gnome.org/extension/1176/argos/) GNOME Shell extension
- `jq` - JSON processor
- `bc` - Calculator
- [Claude Code](https://claude.ai/code) CLI installed and used at least once

## Installation

### 1. Install dependencies

```bash
# Ubuntu/Debian
sudo apt install jq bc

# Fedora
sudo dnf install jq bc

# Arch
sudo pacman -S jq bc
```

### 2. Install Argos extension

Install from [GNOME Extensions](https://extensions.gnome.org/extension/1176/argos/) or via command line:

```bash
# Using gnome-extensions CLI
gnome-extensions install argos@pew.worldwidemann.com
```

### 3. Install the plugin

```bash
# Create Argos directory if it doesn't exist
mkdir -p ~/.config/argos

# Copy the script
cp claude-usage.5m.sh ~/.config/argos/

# Make it executable
chmod +x ~/.config/argos/claude-usage.5m.sh
```

The plugin will automatically appear in your GNOME panel and refresh every 5 minutes.

## Configuration

### Refresh interval

The refresh interval is defined in the filename. To change it, rename the file:

```bash
# Refresh every minute
mv ~/.config/argos/claude-usage.5m.sh ~/.config/argos/claude-usage.1m.sh

# Refresh every 10 minutes
mv ~/.config/argos/claude-usage.5m.sh ~/.config/argos/claude-usage.10m.sh
```

### API Pricing

The script uses official Anthropic API pricing (as of January 2026) to calculate cost savings:

| Model | Input | Output | Cache Read | Cache Write |
|-------|-------|--------|------------|-------------|
| Claude Opus 4.5 | $5/M | $25/M | $0.50/M | $6.25/M |
| Claude Sonnet 4.5 | $3/M | $15/M | $0.30/M | $3.75/M |

To update pricing, edit the `CONFIGURATION` section at the top of the script.

## Data Sources

The plugin reads data from Claude Code's local cache files:

| File | Content |
|------|---------|
| `~/.claude/stats-cache.json` | Usage statistics (tokens, sessions, activity) |
| `~/.claude/.credentials.json` | Subscription type |
| `~/.claude/projects/*/sessions-index.json` | Recent projects |

These files are automatically generated by Claude Code during normal usage.

## Panel Display Logic

- **Normal mode**: Shows `tokens/week │ model │ $cost/week`
- **Multiple sessions**: When 3+ Claude instances are running, shows session count instead of cost

## Troubleshooting

### Plugin not showing

1. Verify Argos is installed and enabled
2. Check the script is executable: `chmod +x ~/.config/argos/claude-usage.5m.sh`
3. Test the script manually: `bash ~/.config/argos/claude-usage.5m.sh`

### No data displayed

Make sure you have used Claude Code at least once. The stats cache is generated after your first session.

### Icons not displaying correctly

The plugin uses Nerd Font icons. If icons appear as boxes or question marks:
1. Install a [Nerd Font](https://www.nerdfonts.com/)
2. Configure your terminal/shell to use it

## License

GNU General Public License v3.0 - See [LICENSE](LICENSE) for details.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## Acknowledgments

- [Argos](https://github.com/p-e-w/argos) by p-e-w for the excellent GNOME extension
- [Claude Code](https://claude.ai/code) by Anthropic
